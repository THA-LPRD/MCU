<!doctype html>

<html>

	<head>
	
        <meta charset="utf-8">

        <meta name="LPRD" content="Einstellungen">

        <link rel="stylesheet" type="text/css" href="style.css">

        <script type="text/javascript">


        window.onload = function () {
            setupForm(); // Set up the form submission handling
            getOperatingMode();
            getDisplayModule();
        };


            async function getOperatingMode() {
            try {
                let response = await fetch('/api/v1/getOperatingMode');
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                let data = await response.json();
                document.getElementById('operatingMode').textContent = data.operatingMode;
            } catch (error) {
                console.error('Error fetching operating mode:', error);
            }
        }
            

            async function getDisplayModule() {
            try {
                let response = await fetch('/api/v1/getDisplayModule');
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                let data = await response.json();
                document.getElementById('displayModule').textContent = data.displayModule;
            } catch (error) {
                console.error('Error fetching display module:', error);
            }
            }


            function setupForm() {
            var form = document.querySelector('form');
            form.onsubmit = function (e) {
                e.preventDefault(); // Prevent the form from submitting normally

                var formData = new FormData(form); // Gather form data

                // Use fetch API to send the form data
                fetch('/api/v1/SetAPCred', {
                    method: 'POST',
                    body: formData
                })
                    .then(response => {
                        if (response.ok) {
                            return response.text(); // Process the text response
                        }
                        throw new Error('Fehler beim Senden der Daten');
                    })
                    .then(data => {
                        document.getElementById('response').textContent = data; // Display the server response
                    })
                    .catch(error => {
                        document.getElementById('response').textContent = 'Error: ' + error.message; // Display error messages
                    });
            };
        }

        

        </script>

        <style>
            main{
                padding-bottom: 50px;
            }

            h2{
                margin-bottom: 50px;
            }

            .text {
                color: #FF0350;
            }

            #home {
                text-align: left;
                margin-left: 20px;
            }

        </style>


    </head>


    <body>

      <header>

        <div id="settings"> <a href="./settings.html"><img src="./icons8-settings-25-w.png"></a> </div>
        <img src="LPRD-Logo.bmp" alt="Logo"> 
        <h1> Low-Power-Raumanzeige</h1>

    </header>


    <div class="container">


        <nav>
            <ul>        
            </ul>
        </nav>

        <a id="home" href="./indexClient.html">Zurück</a>


        <main>

            <h2><u>Einstellungen</u></h2>

            <h3>1. Modus:</h3>
            <p class="text">Sie befinden sich im: <span id="operatingMode"></span>-Modus</p>
            <form>
                <input type="radio" id="standalone" name="modus" value="Standalone-Modus">
                <label for="standalone">Standalone-Modus</label><br>
                <input type="radio" id="network" name="modus" value="Netzwerk-Modus">
                <label for="network">Netzwerk-Modus</label><br><br>
                <input type="submit" value="Speichern">
            </form>

            <br><br>

            <h3>2. Display-Modul:</h3>
            <p class="text">Sie sind verbunden mit dem Display-Modul: <span id="displayModule"></span></p>
            <form>
                <input type="radio" id="waveshare_7.3" name="display">
                <label for="waveshare_7.3">Waveshare 7.3" 4 color</label><br>
                <input type="radio" id="waveshare_9.8" name="display">
                <label for="waveshare_9.8">Waveshare 9.8" 2 color</label><br><br>
                <input type="submit" value="Speichern">
            </form>

            <br><br>

            <h3>3. WiFi Konfiguration:</h3>
            <form>
                <label for="ssid">SSID:</label><br>
                <input type="text" id="ssid" name="ssid" required><br><br>
                <label for="password">Passwort:</label><br>
                <input type="password" id="password" name="password" required><br><br>
                <input type="submit" value="Speichern">
            </form>
            <div id="response"></div> <!-- Place to display the response message -->


            
        </main>


    </div>


    <footer>
        <p>© Projektarbeit Low-Power-Raumanzeige LPRD SoSe24</p>
        <p id="icons8"><a target="_blank" href="https://icons8.com/icon/2969/settings">Settings</a> icon by <a target="_blank" href="https://icons8.com">Icons8</a></p>
    </footer>

      

    </body>
</html>